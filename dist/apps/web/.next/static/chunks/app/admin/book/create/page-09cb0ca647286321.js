(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[398],{92947:function(e,t,a){Promise.resolve().then(a.bind(a,73399))},73399:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return C}});var r=a(27573),n=a(47316),o=a(44853),s=a(94945),i=a(28603),l=a(96604),c=a(63543),m=a(56646),d=a(7653);let u=e=>{let{templateSlug:t,reset:a}=e,{data:r}=(0,c.a)({queryKey:["book-template"],queryFn:()=>i.Z.parser.bySlug(t),enabled:!!t,select:e=>e.data}),{mutateAsync:n}=(0,m.D)({mutationKey:["delete-template"],mutationFn:e=>i.Z.parser.remove(e),onError:()=>(0,l.Jc)("Error while removing template")});return(0,d.useLayoutEffect)(()=>{r&&a({title:r.title,description:r.description,author:r.author,rating:r.rating,genres:r.genres})},[a,r]),{deleteTemplate:n}};var h=a(31783),g=a(73035),x=a(47935),p=a(68444),b=a(12255);let j=p.z.object({slug:p.z.string(),name:p.z.string(),icon:p.z.string()}),k=p.z.object({title:p.z.string(),author:p.z.string(),description:p.z.string().max(1e3).min(10),ebook:p.z.array(b.SH).min(1),rating:p.z.number().min(1).positive(),picture:p.z.string(),genres:p.z.array(j).min(1)});var v=a(54603),y=a(72816);let N=()=>{let e=(0,v.useSearchParams)(),t=(0,g.d)(e.get("template")),a=(0,v.useRouter)(),{control:r,reset:n,watch:o,handleSubmit:s,setValue:c,getValues:d,formState:{errors:p}}=(0,y.cI)({resolver:(0,x.F)(k),mode:"onBlur"}),{deleteTemplate:b}=u({templateSlug:t,reset:n}),{mutateAsync:j,isLoading:N}=(0,m.D)({mutationKey:["create-book"],mutationFn:e=>i.Z.book.create(e),onSuccess:async e=>{console.log("data  in success",e),t&&await b(t),(0,l.Qm)("Book created"),a.push(h.M.bookCatalogRoute)}}),f=s(async e=>{await j(e)});return console.log(o("genres")),{watch:o,control:r,errors:p,setValue:c,reset:n,getValues:d,handleCreate:f,createLoading:N}};var f=a(82961),z=a(59752),C=()=>{let{control:e,...t}=N();return(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"mb-4 text-center text-3xl font-medium",children:"Create book"}),(0,r.jsxs)("div",{className:"mb-4 justify-between gap-5  md:flex",children:[(0,r.jsx)("div",{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"mt-2  text-xl",children:"Cover"}),(0,r.jsx)(s.w,{name:"picture",control:e}),(0,r.jsx)("h1",{className:"mb-2 mt-2  text-xl",children:"Genres"}),(0,r.jsx)(o.Z,{name:"genres",control:e})]})}),(0,r.jsxs)("div",{className:"w-11/12",children:[(0,r.jsxs)("div",{className:"mt-2  gap-3 md:flex",children:[(0,r.jsxs)("div",{className:" md:w-1/2",children:[(0,r.jsx)("h1",{className:"my-2",children:"Title"}),(0,r.jsx)(f.gN,{type:"text",control:e,name:"title",placeholder:"Title"})]}),(0,r.jsxs)("div",{className:" md:w-1/3",children:[(0,r.jsx)("h1",{className:"my-2",children:"Author"}),(0,r.jsx)(f.gN,{type:"text",icon:z.GH,control:e,name:"author",placeholder:"Author"})]}),(0,r.jsxs)("div",{className:"md:w-1/4",children:[(0,r.jsx)("h1",{className:"my-2",children:"Rating"}),(0,r.jsx)(f.gN,{icon:z.Ux,type:"number",control:e,name:"rating",placeholder:"Rating",min:1,max:5})]})]}),(0,r.jsx)("h1",{className:"mb-2 mt-4",children:"Description"}),(0,r.jsx)(f.ld,{control:e,name:"description",placeholder:"Enter description",className:"h-[250px]"})]})]}),(0,r.jsx)(n.Z,{control:e,name:"ebook"}),(0,r.jsx)(f.zx,{size:"md",isLoading:t.createLoading,className:"mt-4",variant:Object.keys(t.errors).length>0?"danger":"foreground",onClick:t.handleCreate,children:"Create"})]})}},31783:function(e,t,a){"use strict";a.d(t,{M:function(){return r},j:function(){return n}});let r={bookCatalogRoute:"/admin/book/catalog",bookCreateRoute:"/admin/book/create",bookCreateWithTemplateRoute:e=>"/admin/book/create?template="+e,bookUpdateRoute:e=>"/admin/book/"+e+"/update",bookOverviewRoute:e=>"/admin/book/"+e,parserCatalogRoute:"/admin/parser/catalog",userCatalogRoute:"/admin/user/catalog",dashboard:"/admin/dashboard"},n={login:"/login"}}},function(e){e.O(0,[201,485,628,878,382,347,823,463,249,63,675,598,747,362,677,744],function(){return e(e.s=92947)}),_N_E=e.O()}]);