(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[811],{37809:function(e,s,t){Promise.resolve().then(t.bind(t,60275))},60275:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return P}});var i=t(27573),n=t(47316),a=t(44853),o=t(94945),r=t(82961),l=t(92766),c=t(28603),d=t(72133);function m(e,s){return!0===e||Array.isArray(e)?s:Object.fromEntries(Object.keys(e).map(t=>[t,m(e[t],s[t])]))}var u=t(96604),h=t(73035),x=t(47935),p=t(84983),b=t(63543),g=t(56646),j=t(68444),y=t(12255);let f=j.z.object({slug:j.z.string(),name:j.z.string(),icon:j.z.string()}),N=j.z.object({title:j.z.string().optional(),author:j.z.string().optional(),description:j.z.string().max(1e3).min(10).optional(),ebook:j.z.array(y.SH).min(1).optional(),isPublic:j.z.boolean().optional(),rating:j.z.number().min(1).positive().optional(),picture:j.z.string().optional(),genres:j.z.array(f).min(1).optional()});var k=t(59752),v=t(54603),z=t(7653),w=t(72816),P=()=>{let e=(0,v.useParams)(),s=(0,h.d)(e.slug),t=(0,p.NL)(),{control:j,reset:y,handleSubmit:f,formState:{errors:P,dirtyFields:E}}=(0,w.cI)({resolver:(0,x.F)(N)}),{data:O}=(0,b.a)({queryKey:["book-update-info",s],queryFn:()=>c.Z.book.adminInfoBySlug(s),select:e=>e.data}),{data:S}=(0,b.a)({queryKey:["stored-ebook",s],queryFn:()=>c.Z.ebook.storedEbookBySlug(s),select:e=>e.data}),{mutateAsync:Z,isLoading:_}=(0,g.D)({mutationKey:["update-book"],mutationFn:e=>c.Z.book.update(s,e),onSuccess:async()=>{await t.invalidateQueries({queryKey:["book-update-info",s,"stored-ebook",s]})}});(0,z.useEffect)(()=>{O&&S&&y({title:O.title,description:O.description,author:O.author,rating:O.rating,genres:O.genres,picture:O.picture,ebook:S})},[y,O,s,S]);let q=f(async e=>{if(!Object.keys(m(E,e)).length)return(0,u.Jc)("Please fill some fields to update the book");await Z(m(E,e))});return(console.log(E),O&&S)?(0,i.jsxs)("div",{children:[(0,i.jsxs)("h1",{className:"mb-4 text-center text-3xl font-medium",children:["Update ",(0,i.jsx)("b",{children:O.title})," book"]}),(0,i.jsxs)("div",{className:"mb-4 justify-between gap-5  md:flex",children:[(0,i.jsx)("div",{children:(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"mt-2  text-xl",children:"Cover"}),(0,i.jsx)(o.w,{name:"picture",control:j}),(0,i.jsx)("h1",{className:"my-1",children:"Genres"}),(0,i.jsx)(a.Z,{name:"genres",control:j}),(0,i.jsxs)("div",{className:"mt-2 flex items-center justify-between",children:[(0,i.jsx)("h1",{className:"",children:"Visibility"}),(0,i.jsx)(r.zx,{size:"sm",className:(0,d.cn)("",O.isPublic?"bg-success":"bg-warning"),isLoading:_,onClick:async()=>{await Z({isPublic:!O.isPublic})},children:O.isPublic?"Hide":"Show"})]})]})}),(0,i.jsxs)("div",{className:"w-11/12",children:[(0,i.jsxs)("div",{className:"mt-2 gap-3 md:flex",children:[(0,i.jsxs)("div",{className:" md:w-1/2",children:[(0,i.jsx)("h1",{className:"my-2",children:"Title"}),(0,i.jsx)(r.gN,{type:"text",control:j,name:"title",placeholder:"Title"})]}),(0,i.jsxs)("div",{className:" md:w-1/3",children:[(0,i.jsx)("h1",{className:"my-2",children:"Author"}),(0,i.jsx)(r.gN,{type:"text",icon:k.GH,control:j,name:"author",placeholder:"Author"})]}),(0,i.jsxs)("div",{className:"md:w-1/4",children:[(0,i.jsx)("h1",{className:"my-2",children:"Rating"}),(0,i.jsx)(r.gN,{icon:k.Ux,type:"number",control:j,name:"rating",placeholder:"Rating",min:1,max:5})]})]}),(0,i.jsx)("h1",{className:"my-2",children:"Description"}),(0,i.jsx)(r.ld,{control:j,name:"description",placeholder:"Enter description",className:"h-[240px]"})]})]}),(0,i.jsx)(n.Z,{control:j,name:"ebook"}),(0,i.jsx)(r.zx,{size:"sm",isLoading:_,className:"mt-4",variant:Object.keys(P).length>0?"danger":"foreground",onClick:q,children:"Update"})]}):(0,i.jsx)(l.Z,{})}}},function(e){e.O(0,[201,485,628,878,382,347,823,463,249,63,675,598,747,362,677,744],function(){return e(e.s=37809)}),_N_E=e.O()}]);